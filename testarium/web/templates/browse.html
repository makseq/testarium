<link href="/static/fonts/stylesheet.css" rel="stylesheet" type="text/css"/>

<link rel="stylesheet" href="/static/styles/jquery.json-viewer.css">
<script src="/static/scripts/jquery.min.js"></script>
<script src="/static/scripts/jquery.json-viewer.js"></script>

<style>
    * {
        font-family: 'Gudea', monospace;
    }
    .browse {
        display:flex;
        flex-direction:row;
        align-items:flex-start;
        height: 100%;
    }
    .browse .files {
        width:40%;
    }
    .browse .preview {
        width:60%;
        height:100%;
        display:flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .browse .json {
        width:100%;
        height:50%;
        overflow: auto;
        background: #f0f4f7;
    }
    .browse pre {
        padding: 0 0 0 2px;
        margin: 0;
    }
    .browse .preview .header {
        display: block;
        background-color: #f5f9fb;
    }
    .browse .preview .full-screen-button {
        text-decoration: underline;
        cursor: pointer;
        color: blue;
    }
    .browse .preview .full-screen-button:after {
        content: '[full]';
    }

    .overlay {
        position: fixed;
        overflow: auto;
        width: 100%;
        height: 100%;
        min-height: 100%;
        left: 0;
        top: 0;
        bottom: 0;
        right: 0;
        z-index: 10;
        object-fit: contain;
    }
    .overlay pre {
       padding-left: 10%;
    }
    .overlay .header {
       padding-left: 10%;
    }
    .overlay .full-screen-button:after {
        content: '[back]' !important;
    }

</style>

<div class="browse">
    <div class="files">
        <ul>
            {% for file in files %}
            <li><a href="{{ file[0] }}">{{ file[1] }}</a></li>
            {% endfor %}
        </ul>
    </div>

    <div class="preview">
        <div id="config" class="json"><span class="header" title="double click on header to change screen mode">config.json <span class="full-screen-button"></span></span><pre></pre></div>
        <div id="desc" class="json"><span class="header" title="double click on header to change screen mode">desc.json <span class="full-screen-button"></span></span><pre></pre></div>
    </div>
</div>

<script>
    function load_json(name) {
        $.getJSON(window.location.href + '/' + name + '.json').success(function (d) {
            var obj = $('#'+name+' pre');
            obj.jsonViewer(d, {collapsed: true, withQuotes: false});
            obj.find('.json-toggle').first().click();
            obj.find('.json-toggle').first().hide();

            // full screen button binding
            function fullscreen(){ $('#'+name).toggleClass('overlay') }
            $('#'+name+' .full-screen-button').click(fullscreen);
            $('#'+name+' .header').dblclick(fullscreen);
        });
    }
    load_json('config');
    load_json('desc');
</script>
